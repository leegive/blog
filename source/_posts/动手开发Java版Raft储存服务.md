---
title: 动手开发Java版Raft储存服务
date: 2019-01-24 16:44:09
tags: Raft
---

为了加强对Raft算法深入理解，而且，我另一个开源项目（进行中）需要用到分布式一致性算法，但不想借用zk,etcd等第三方系统，需要轻量级地维护微服务中的一些状态。本文记录一边学习一边开发Raft算法KV储存的项目过程。

<!-- more -->

# Raft算法基础知识

Raft 是用来管理复制日志（replicated log）的一致性协议。它跟 multi-Paxos 作用相同，效率也相当，但是它的组织结构跟 Paxos 不同。这使得 Raft 比 Paxos 更容易理解并且更容易在工程实践中实现。为了使 Raft 协议更易懂，Raft 将一致性的关键元素分开，如 leader 选举、日志复制和安全性，并且它实施更强的一致性以减少必须考虑的状态的数量。用户研究的结果表明，Raft 比 Paxos 更容易学习。 Raft 还包括一个用于变更集群成员的新机制，它使用重叠的大多数（overlapping majorities）来保证安全性。

Raft算法我们看着四个部分：

- leader 选举
- 日志复制
- 成员变量
- 日志压缩

所有写操作都是由leader发起，从而保证数据处理逻辑变得简单。leader的选举通过比较每个节点的逻辑时间（term）大小，以及日志index的大小。

日志复制可以说是Raft核心，Raft为了保证多节点之间日志的一致。当日志一致，我们可以认为整个系统的状态是一致的。这个日志可以理解成mysql的binlog.

# 基础选型

- Raft算法，自己实现
- 网络通信，grpc






